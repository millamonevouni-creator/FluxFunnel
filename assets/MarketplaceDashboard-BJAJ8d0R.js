import{j as e,b}from"./index-eBZt-p7n.js";import{r,R as $}from"./vendor-KfUPlHYY.js";import{C as W,a as G}from"./CustomEdge-C1C3FYoo.js";import{P as H}from"./PremiumLockScreen-BhDJvr9b.js";import{ak as X,S as E,a as j,b8 as J,a2 as K,j as S,aN as Y,aP as Z,m as ee,g as ae,a8 as v,n as se,d as te,X as le,aD as re,aF as ie,aH as oe}from"./ui-DazhNhsc.js";import"./utils-ig63ahen.js";const ue=({userPlan:A,onDownload:N,isDark:l,t:s,userId:w,onUpgrade:F})=>{const[L,D]=r.useState([]),[P,k]=r.useState(!0),[y,R]=r.useState(""),[c,O]=r.useState("ALL"),[M,z]=r.useState(null),[i,u]=r.useState(null),[h,g]=r.useState(null),[o,p]=r.useState({label:"",description:""}),q=$.useMemo(()=>({custom:W}),[]);$.useMemo(()=>({custom:G}),[]);const x=async()=>{k(!0);try{const a=await b.templates.listPublic(w);D(a)}catch(a){console.error(a)}finally{k(!1)}};r.useEffect(()=>{x()},[]);const V=async(a,t)=>{try{await b.templates.rate(a,t),z(null),x(),alert("Obrigado pela sua avaliação!")}catch{alert("Erro ao enviar avaliação.")}},_=async a=>{window.confirm(s("reportTemplate")+"?")&&alert("Denúncia enviada para a moderação. Obrigado por ajudar a manter o marketplace seguro.")},I=async a=>{window.confirm("Tem certeza que deseja excluir esta estratégia pendente?")&&(await b.templates.delete(a),x())},U=a=>{g(a),p({label:a.customLabel||"",description:a.customDescription||""})},B=async()=>{h&&(await b.templates.update(h.id,{custom_label:o.label,custom_description:o.description}),g(null),x())},C=L.filter(a=>{var t;return(t=a.customLabel)==null?void 0:t.toLowerCase().includes(y.toLowerCase())}).sort((a,t)=>c==="RATED"?(t.rating||0)-(a.rating||0):c==="DOWNLOADS"?(t.downloads||0)-(a.downloads||0):c==="FEATURED"?(t.isFeatured?1:0)-(a.isFeatured?1:0):0),Q=A==="PREMIUM",T=l?"bg-slate-900 border-slate-800":"bg-white border-slate-200",n=l?"text-white":"text-slate-900",d=l?"text-slate-400":"text-slate-500";return Q?e.jsxs("div",{className:`flex-1 overflow-y-auto h-full p-8 transition-colors duration-300 ${l?"bg-slate-950":"bg-slate-50"}`,children:[e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-end gap-6 mb-12",children:[e.jsx("div",{children:e.jsxs("div",{className:"flex items-center gap-4 mb-3",children:[e.jsx("div",{className:"p-3 bg-indigo-600 rounded-2xl shadow-lg shadow-indigo-500/20",children:e.jsx(X,{size:28,className:"text-white"})}),e.jsxs("div",{children:[e.jsx("h2",{className:`text-4xl font-black tracking-tight ${n}`,children:s("marketplace")}),e.jsx("p",{className:`text-sm font-medium mt-1 ${d}`,children:s("marketplaceDesc")})]})]})}),e.jsx("div",{className:"flex flex-wrap gap-2 p-1 bg-slate-200 dark:bg-slate-800 rounded-xl",children:[{id:"ALL",label:"Recentes"},{id:"FEATURED",label:"Destaques",icon:e.jsx(E,{size:12})},{id:"RATED",label:s("topRated"),icon:e.jsx(j,{size:12})},{id:"DOWNLOADS",label:s("mostDownloaded"),icon:e.jsx(J,{size:12})}].map(a=>e.jsxs("button",{onClick:()=>O(a.id),className:`px-4 py-2 rounded-lg text-xs font-black transition-all flex items-center gap-2 ${c===a.id?"bg-white dark:bg-slate-700 shadow-sm text-indigo-600 dark:text-indigo-400":"text-slate-500 hover:text-slate-700 dark:hover:text-slate-300"}`,children:[a.icon,a.label]},a.id))})]}),e.jsxs("div",{className:`mb-12 group p-1 rounded-2xl border shadow-xl flex items-center transition-all ${l?"bg-slate-900 border-slate-700 focus-within:border-indigo-500":"bg-white border-slate-200 focus-within:border-indigo-400"}`,children:[e.jsx("div",{className:"p-3",children:e.jsx(K,{className:"text-slate-400 group-focus-within:text-indigo-500 transition-colors",size:24})}),e.jsx("input",{type:"text",placeholder:s("searchTemplates"),value:y,onChange:a=>R(a.target.value),className:"flex-1 bg-transparent border-none outline-none p-4 text-xl font-medium text-slate-800 dark:text-white placeholder-slate-400"})]}),P?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:[1,2,3,4,5,6].map(a=>e.jsx("div",{className:`h-[450px] rounded-[2.5rem] animate-pulse ${l?"bg-slate-900":"bg-slate-200"}`},a))}):C.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-20 opacity-50",children:[e.jsx(S,{size:64,className:"mb-4"}),e.jsx("h3",{className:"text-xl font-bold",children:"Nenhuma estratégia encontrada"}),e.jsx("p",{children:"Tente termos diferentes ou limpe os filtros."})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:C.map(a=>{var t,f;return e.jsxs("div",{className:`group relative flex flex-col rounded-[2.5rem] border shadow-sm hover:shadow-2xl transition-all duration-500 overflow-hidden ${T} hover:-translate-y-2`,children:[a.isFeatured&&e.jsxs("div",{className:"absolute top-6 left-6 z-10 bg-amber-400 text-amber-950 px-4 py-1.5 rounded-full text-[10px] font-black uppercase tracking-widest flex items-center gap-2 shadow-lg",children:[e.jsx(E,{size:12})," Destaque"]}),a.status==="PENDING"&&e.jsxs("div",{className:"absolute top-6 right-6 z-10 flex gap-2",children:[e.jsxs("div",{className:"bg-amber-100 text-amber-700 border border-amber-200 px-4 py-1.5 rounded-full text-[10px] font-black uppercase tracking-widest flex items-center gap-2 shadow-sm",children:[e.jsx(S,{size:12})," Em Análise"]}),w===a.authorId&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>U(a),className:"bg-white p-1.5 rounded-full text-slate-500 hover:text-indigo-600 shadow-sm border transition-colors",title:"Editar",children:e.jsx(Y,{size:14})}),e.jsx("button",{onClick:()=>I(a.id),className:"bg-white p-1.5 rounded-full text-slate-500 hover:text-red-600 shadow-sm border transition-colors",title:"Excluir",children:e.jsx(Z,{size:14})})]})]}),e.jsxs("div",{className:"h-56 bg-slate-100 dark:bg-slate-800 relative overflow-hidden flex items-center justify-center group-hover:bg-indigo-50 dark:group-hover:bg-indigo-900/10 transition-colors duration-700",children:[e.jsx("div",{className:"absolute inset-0 opacity-[0.03] bg-[radial-gradient(#000_1px,transparent_1px)] [background-size:16px_16px]"}),e.jsx(ee,{size:80,className:"text-slate-300 dark:text-slate-600 group-hover:scale-125 group-hover:text-indigo-400/50 transition-all duration-1000 ease-out"}),e.jsxs("div",{className:"absolute bottom-4 right-4 flex gap-2",children:[e.jsx("button",{onClick:()=>u(a),className:"p-2 bg-white/90 dark:bg-slate-900/90 backdrop-blur-sm rounded-xl border border-slate-200 dark:border-slate-700 text-indigo-600 transition-all hover:scale-110","aria-label":"Visualizar",title:"Visualizar",children:e.jsx(ae,{size:16})}),e.jsxs("div",{className:"bg-white/90 dark:bg-slate-900/90 backdrop-blur-sm px-3 py-1.5 rounded-xl text-[10px] font-black shadow-sm flex items-center gap-2 border dark:border-slate-700",children:[e.jsx(v,{size:12,className:"text-indigo-600"}),a.downloads||0]}),e.jsxs("div",{className:"bg-white/90 dark:bg-slate-900/90 backdrop-blur-sm px-3 py-1.5 rounded-xl text-[10px] font-black shadow-sm flex items-center gap-2 border dark:border-slate-700",children:[e.jsx(j,{size:12,className:"text-amber-500 fill-amber-500"}),((t=a.rating)==null?void 0:t.toFixed(1))||"0.0"]})]})]}),e.jsxs("div",{className:"p-8 flex-1 flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-gradient-to-br from-slate-200 to-slate-300 dark:from-slate-700 dark:to-slate-800 flex items-center justify-center text-[10px] font-black uppercase shadow-sm",children:((f=a.authorName)==null?void 0:f.substring(0,2))||"FF"}),e.jsx("span",{className:"text-xs font-bold text-slate-500 tracking-wide uppercase",children:a.authorName||"Autor Oficial"})]}),e.jsx("button",{onClick:()=>_(a.id),className:"text-slate-400 hover:text-red-500 transition-colors",title:s("reportTemplate"),children:e.jsx(se,{size:14})})]}),e.jsx("h3",{className:`text-2xl font-black mb-3 line-clamp-1 leading-tight ${n}`,children:a.customLabel}),e.jsx("p",{className:`text-sm mb-8 flex-1 line-clamp-3 leading-relaxed font-medium ${d}`,children:a.customDescription}),e.jsx("div",{className:"flex gap-2",children:e.jsxs("button",{onClick:()=>{N(a),z(a.id)},className:"flex-1 py-4 bg-indigo-600 hover:bg-indigo-500 text-white rounded-2xl font-black flex items-center justify-center gap-3 transition-all shadow-xl shadow-indigo-500/20 active:scale-95 group-hover:px-6",children:[e.jsx(v,{size:20}),s("downloadTemplate")]})}),M===a.id&&e.jsxs("div",{className:"mt-4 p-4 bg-amber-50 dark:bg-amber-900/10 border border-amber-100 dark:border-amber-900/30 rounded-2xl animate-fade-in-up",children:[e.jsx("p",{className:"text-[10px] font-black uppercase text-amber-600 mb-2 text-center",children:"Avalie esta estratégia"}),e.jsx("div",{className:"flex justify-center gap-2",children:[1,2,3,4,5].map(m=>e.jsx("button",{onClick:()=>V(a.id,m),className:"text-amber-400 hover:scale-125 transition-transform","aria-label":`Avaliar com ${m} estrelas`,title:`Avaliar com ${m} estrelas`,children:e.jsx(j,{size:24,className:"hover:fill-amber-400"})},m))})]})]})]},a.id)})}),e.jsxs("div",{className:"mt-20 py-12 border-t dark:border-slate-800 flex flex-col items-center text-center",children:[e.jsx("div",{className:"p-4 bg-green-100 dark:bg-green-900/20 rounded-full mb-4",children:e.jsx(te,{size:32,className:"text-green-600"})}),e.jsx("h4",{className:`text-2xl font-black mb-2 ${n}`,children:"Sua estratégia no radar?"}),e.jsx("p",{className:`${d} max-w-lg mb-8`,children:"Publique seu melhor funil e torne-se uma referência na comunidade. Projetos aprovados recebem badge de Autor Verificado."}),e.jsx("button",{onClick:()=>window.scrollTo({top:0,behavior:"smooth"}),className:"font-black text-indigo-600 hover:text-indigo-500 underline underline-offset-8",children:"Voltar para Meus Projetos e Compartilhar"})]})]}),i&&e.jsx("div",{className:"fixed inset-0 z-[200] flex items-center justify-center p-8 bg-black/90 backdrop-blur-xl animate-fade-in-up",children:e.jsxs("div",{className:`w-full max-w-6xl rounded-[3rem] border overflow-hidden flex flex-col h-[90vh] ${T}`,children:[e.jsxs("div",{className:"p-8 border-b border-slate-100 dark:border-slate-800 flex justify-between items-center bg-slate-50/50 dark:bg-slate-900/50",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:`text-3xl font-black ${n}`,children:[s("quickLook"),": ",i.customLabel]}),e.jsx("p",{className:d,children:"Visualizando estrutura do fluxo."})]}),e.jsx("button",{onClick:()=>u(null),className:"p-4 hover:bg-slate-200 dark:hover:bg-slate-800 rounded-3xl transition-all","aria-label":"Fechar",title:"Fechar",children:e.jsx(le,{size:28})})]}),e.jsx("div",{className:"flex-1 bg-slate-50 dark:bg-slate-900 overflow-hidden relative",children:e.jsxs(re,{nodes:i.nodes.map(a=>({...a,id:`preview-${a.id}`,draggable:!1,selectable:!1,data:{...a.data,isPresentationMode:!0}})),edges:i.edges.map(a=>({...a,id:`preview-${a.id}`,source:`preview-${a.source}`,target:`preview-${a.target}`,type:"default",animated:!0,style:{stroke:l?"#a5b4fc":"#64748b",strokeWidth:2}})),nodeTypes:q,fitView:!0,proOptions:{hideAttribution:!0},nodesDraggable:!1,nodesConnectable:!1,elementsSelectable:!1,children:[e.jsx(ie,{color:l?"#334155":"#cbd5e1",gap:24}),e.jsx(oe,{showInteractive:!1})]})},i.id),e.jsx("div",{className:"p-8 border-t border-slate-100 dark:border-slate-800 flex justify-center gap-4 bg-white dark:bg-slate-900",children:e.jsxs("button",{onClick:()=>{N(i),u(null)},className:"px-12 py-5 bg-indigo-600 text-white rounded-[2rem] font-black shadow-xl shadow-indigo-500/30 hover:scale-105 active:scale-95 transition-all flex items-center gap-3",children:[e.jsx(v,{size:24})," ",s("downloadTemplate")]})})]})}),h&&e.jsx("div",{className:"fixed inset-0 z-[200] flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm",children:e.jsxs("div",{className:`w-full max-w-lg rounded-2xl shadow-2xl p-8 border ${l?"bg-slate-900 border-slate-700":"bg-white border-slate-200"}`,children:[e.jsx("h3",{className:`text-2xl font-bold mb-6 ${n}`,children:"Editar Estratégia"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"edit-label",className:`block text-sm font-bold mb-2 ${d}`,children:"Nome"}),e.jsx("input",{id:"edit-label",value:o.label,onChange:a=>p({...o,label:a.target.value}),placeholder:"Nome da estratégia",title:"Nome da estratégia",className:"w-full p-3 rounded-xl border bg-transparent outline-none focus:border-indigo-500 transition-colors"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"edit-description",className:`block text-sm font-bold mb-2 ${d}`,children:"Descrição"}),e.jsx("textarea",{id:"edit-description",value:o.description,onChange:a=>p({...o,description:a.target.value}),placeholder:"Descrição detalhada",title:"Descrição da estratégia",className:"w-full p-3 rounded-xl border bg-transparent outline-none focus:border-indigo-500 transition-colors h-32 resize-none"})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{onClick:B,className:"flex-1 py-3 bg-indigo-600 text-white rounded-xl font-bold hover:bg-indigo-500",children:"Salvar Alterações"}),e.jsx("button",{onClick:()=>g(null),className:"flex-1 py-3 bg-slate-200 dark:bg-slate-800 text-slate-700 dark:text-slate-300 rounded-xl font-bold",children:"Cancelar"})]})]})]})})]}):e.jsx(H,{title:s("premiumOnly"),description:"O Marketplace é o centro estratégico da nossa elite. Assine o Premium para baixar e compartilhar funis que já geraram milhões.",features:["Acesso ilimitado a templates","Compartilhe suas estratégias","Vote e avalie modelos"],onUpgrade:F,isDark:l})};export{ue as default};
